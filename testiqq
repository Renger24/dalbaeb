-- Создаем ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "CalculatorGui"
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Создаем Frame с белым фоном
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 250, 0, 300)
Frame.BackgroundColor3 = Color3.new(1, 1, 1)
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0.5, -125, 0.5, -150)
Frame.Draggable = true -- Включаем возможность перемещения
Frame.Parent = ScreenGui

-- Создаем поле для перетаскивания окна
local DragArea = Instance.new("TextButton")
DragArea.Size = UDim2.new(1, 0, 0, 30)
DragArea.BackgroundColor3 = Color3.new(0, 0, 0)
DragArea.BackgroundTransparency = 0.7
DragArea.BorderSizePixel = 0
DragArea.Text = ""
DragArea.AutoButtonColor = false -- Отключаем автоизменение цвета при наведении курсора
DragArea.Parent = Frame

-- Создаем TextBox для вывода результата
local ResultBox = Instance.new("TextBox")
ResultBox.Size = UDim2.new(0.9, 0, 0.2, 0)
ResultBox.Position = UDim2.new(0.05, 0, 0.15, 0)
ResultBox.BackgroundColor3 = Color3.new(1, 1, 1)
ResultBox.BorderSizePixel = 0
ResultBox.ClearTextOnFocus = false
ResultBox.Font = Enum.Font.SourceSans
ResultBox.FontSize = Enum.FontSize.Size24
ResultBox.Text = ""
ResultBox.TextScaled = true
ResultBox.Parent = Frame

-- Создаем функцию для обработки нажатий кнопок
local function buttonClick(value)
    -- Операции при нажатии на кнопки
    if value == "=" then
        -- Вычисляем результат и выводим
        local expression = loadstring("return " .. ResultBox.Text)
        if expression then
            local success, result = pcall(expression)
            if success then
                ResultBox.Text = tostring(result)
            else
                ResultBox.Text = "Ошибка"
            end
        else
            ResultBox.Text = "Ошибка"
        end
    elseif value == "C" then
        -- Очищаем поле с результатом
        ResultBox.Text = ""
    elseif value == "Закрыть" then
        -- Закрываем окно
        ScreenGui:Destroy()
    else
        -- Добавляем нажатую кнопку к выражению
        ResultBox.Text = ResultBox.Text .. value
    end
end

-- Создаем таблицу с кнопками и их расположением
local buttons = {
    {"7", "8", "9", "/"},
    {"4", "5", "6", "*"},
    {"1", "2", "3", "-"},
    {"0", ".", "=", "+"},
    {"C", "Закрыть"}
}

local buttonSizeX = 0.2
local buttonSizeY = 0.15
local buttonMargin = 0.02

-- Создаем кнопки
for i, row in ipairs(buttons) do
    for j, value in ipairs(row) do
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(buttonSizeX, -buttonMargin, buttonSizeY, -buttonMargin)
        button.Position = UDim2.new((j-1)*(buttonSizeX+buttonMargin), buttonMargin, (i-1)*(buttonSizeY+buttonMargin)+0.3, buttonMargin)
        button.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
        button.BorderSizePixel = 0
        button.Font = Enum.Font.SourceSans
        button.FontSize = Enum.FontSize.Size24
        button.Text = value
        button.TextScaled = true
        button.Parent = Frame
        
        -- Привязываем обработчик нажатия кнопки
        button.MouseButton1Click:Connect(function()
            buttonClick(value)
        end)
    end
end
